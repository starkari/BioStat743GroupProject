---
title: "Workfile"
author: "Group"
output: pdf_document
---

```{r}
library(readr)
library(dplyr)
library(ggplot2)
library(ggpubr)
```


```{r message=FALSE, warning=FALSE}
data <- read.csv("Data/initial_table.csv")
#mean(data$AGE, na.rm = T)
data.work <- select(data, ID, AGE, SEX, IBS_POST, DLIT_AG, SIM_GIPERT, endocr_01, endocr_02, ZSN, LET_IS) 
data.work <- na.omit(data.work)
dim(data.work) # obs = 1381 

# exploratory analysis
mean(data.work$AGE) #61.3997
table(data.work$SEX) # female(0): 502, male(1): 879
table(data.work$IBS_POST) # no CHD(0): 354, exertional angina pectoris(1):443, unstable angina pectoris(2):584
mean(data.work$DLIT_AG) # 3.3407
table(data.work$SIM_GIPERT) # no(0): 1337, yes(1): 44
table(data.work$endocr_01) # no(0): 1194, yes(1):187
table(data.work$endocr_02) # no(0): 1349, yes(1):32

# distribution plots for single variable
age.hist <- ggplot(data.work, aes(data.work$AGE)) + geom_histogram() + labs(title = "age distribution", x = "age")

sex.plot <- ggplot(data.work, aes(as.factor(data.work$SEX))) + geom_bar() + labs(title = "distribution of sex", x = "sex") + scale_x_discrete(labels = c("female", "male"))

ibs.plot <- ggplot(data.work, aes(as.factor(data.work$IBS_POST))) + geom_bar() + labs(title = "distribution of CHD in recent weeks", x = "type of CHD") + scale_x_discrete(labels = c("no CHD", "extertional angina pectoris", "unstable angina pectoris"))

duration.hist <- ggplot(data.work, aes(data.work$DLIT_AG)) + geom_histogram() + labs(title = "duration of arterial hypertension", x = "years")

hypertension.plot <- ggplot(data.work, aes(as.factor(data.work$SIM_GIPERT))) + geom_bar() + labs(title = "distribution of hypertension", x = "hypertension") + scale_x_discrete(labels = c("no", "yes"))

diabetes.plot <- ggplot(data.work, aes(as.factor(data.work$endocr_01))) + geom_bar() + labs(title = "distribution of diabetes", x = "diabetes") + scale_x_discrete(labels = c("no", "yes"))

obesity.plot <- ggplot(data.work, aes(as.factor(data.work$endocr_02))) + geom_bar() + labs(title = "distribution of obesity", x = "obesity") + scale_x_discrete(labels = c("no", "yes"))

ggarrange(age.hist, duration.hist, ncol = 2, nrow = 1)

ggarrange(sex.plot, ibs.plot, hypertension.plot, diabetes.plot, obesity.plot, ncol = 3, nrow = 2)

# plots of the relationship between CHD and single variable

```



```{r}
names(data)
```


## Ariane
```{r}
#process
```

```{r}

```








## Alona
```{r}
#second chance-you did it
```


## Jadey
```{r}
data.work2 <- data.work
data.work2$death <- ifelse(data.work$LET_IS == 0, 0, 1)
table(data.work2$death) # survive: 1212, dead: 191

# fit logistic model

death.fit <- glm(death ~ . - ID - LET_IS - ZSN, data = data.work2, family = binomial)
summary(death.fit)

#death.fit2 <- glm(death ~ AGE + IBS_POST + endocr_02, data = data.work2, family = binomial)
#summary(death.fit2)

#anova(death.fit, death.fit2)
```


## Minsu
```{r}

```






